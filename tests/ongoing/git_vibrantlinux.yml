- name: "Installing vibrantLinux required dependencies"
  dnf:
    state: latest
    name:
      - git
      - gstreamer1-plugins-good-qt
      - qt
      - qt-settings
      - qt6-qtbase
      - qt6-qtbase-common
      - qt6-qtbase-devel
      - qt6-qtbase-gui
      - qt6-qtdeclarative
      - qt6-qtdeclarative-devel
      - qt6-qtsvg
      - qt6-qtwayland
      - qt6-qtwayland-devel
      - qt6-rpm-macros
      - qt6-srpm-macros
      - libxcb
      - libxcb-devel
      - golang-github-burntsushi-xgbutil-devel
      - libX11-common
      - libX11-xcb
      - xcb-util-wm
      - xcb-util-wm-devel

- name: "Checking if dir exists"
  ansible.builtin.stat:
    path: /home/{{ lookup('env', 'USER') }}/Documents/from_git/libvibrant
    get_checksum: no
  register: p

- name: "Reporting if dir exists"
  ansible.builtin.debug:
    msg: "Path exists and is a directory"
  when: p.stat.isdir is defined and p.stat.isdir

- name: "Cloning GitHub repo: vibrantLinux"
  ansible.builtin.git:
    repo: 'https://github.com/zee-mzha/vibrantLinux.git'
    dest: /home/{{ lookup('env', 'USER') }}/Documents/from_git/vibrantlinux
  when: p.stat.exists == False

- name: "Changing from the use of qmake-qt5 to qmake-qt6"
  ansible.builtin.lineinfile:
    path: /home/{{ lookup('env', 'USER') }}/Documents/from_git/vibrantlinux/update.sh
    regexp: '^qt5'
    line: qt6

- name: "Installing vibrantLinux"
  ansible.builtin.shell: update.sh
  args:
    chdir: /home/{{ lookup('env', 'USER') }}/Documents/from_git/vibrantlinux